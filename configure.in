dnl Process this file with autoconf to produce a configure script.
AC_INIT()
AC_CONFIG_AUX_DIR(config)

AM_PROG_LIBTOOL
AM_INIT_AUTOMAKE(mpeg4ip, 0.7)

dnl Checks for programs.
AC_PROG_CC
AC_PROG_CXX
AC_PROG_LIBTOOL

dnl Checks for libraries.

dnl Checks for header files.
AC_HEADER_STDC
AC_CHECK_HEADERS(fcntl.h unistd.h)

dnl Checks for typedefs, structures, and compiler characteristics.

dnl Checks for library functions.
AC_CHECK_FUNCS(strerror)

dnl Allow server build to be disabled
AC_ARG_ENABLE(server, 
[  --enable-server        enable server build],
[ case "${enableval}" in
  yes) server=true ;;
  no)  server=false ;;
  *)   AC_MSG_ERROR(bad value ${enableval} for --enable-server) ;;
esac],
[server=true])
AM_CONDITIONAL(SERVER, test $server = true)

dnl Allow player build to be disabled
AC_ARG_ENABLE(player, 
[  --enable-player        enable player build],
[ case "${enableval}" in
  yes) player=true ;;
  no)  player=false ;;
  *)   AC_MSG_ERROR(bad value ${enableval} for --player-server) ;;
esac],
[player=true])
AM_CONDITIONAL(PLAYER, test $player = true)

AC_OUTPUT( \
	Makefile \
	common/Makefile \
	common/mp4/Makefile \
	common/video/Makefile \
	server/Makefile \
	server/audio/Makefile \
	server/audio/faac/Makefile \
	server/video/Makefile \
	server/video/divx/Makefile \
	server/lib/Makefile \
	server/lib/avi/Makefile \
	server/util/Makefile \
	server/util/avi2raw/Makefile \
	server/util/lboxcrop/Makefile \
	server/util/mp4apkt/Makefile \
	server/util/mp4vpkt/Makefile \
	server/util/mp4vhdr/Makefile \
	server/util/mp4dump/Makefile \
	server/util/mp4extract/Makefile \
	player/Makefile \
	player/lib/Makefile \
	player/lib/sdp/Makefile \
	player/lib/rtsp/Makefile \
	player/lib/audio/Makefile \
	player/lib/audio/faad/Makefile \
	player/lib/audio/mp3/Makefile \
	player/lib/video/Makefile \
	player/lib/video/divx/Makefile \
	player/src/Makefile \
	player/src/codec/Makefile \
	player/src/codec/aa/Makefile \
	player/src/codec/divx/Makefile \
	player/src/codec/mp3/Makefile \
	player/src/codec/mpeg4/Makefile \
	player/src/codec/wav/Makefile \
	util/Makefile \
	util/yuv/Makefile \
)
