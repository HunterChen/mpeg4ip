<HTML>
<HEAD>
<TITLE>Streaming Server Admin: <%%ECHODATA /server/qtssSvrDefaultDNSName%%></TITLE>
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript">		
function setOpts() {
 	document.forms[0].elements[1].defaultValue = document.forms[0].elements[1].value;
 	document.forms[0].elements[2].defaultValue = document.forms[0].elements[2].value;
 	document.forms[0].elements[3].defaultChecked = document.forms[0].elements[3].checked;
 	document.forms[0].elements[4].defaultChecked = document.forms[0].elements[4].checked;
 	document.forms[0].elements[5].defaultValue = document.forms[0].elements[5].value;
 	document.forms[0].elements[6].defaultValue = document.forms[0].elements[6].value;
 	document.forms[0].elements[7].options[0].defaultSelected = document.forms[0].elements[7].options[0].selected;
 	document.forms[0].elements[7].options[1].defaultSelected = document.forms[0].elements[7].options[1].selected;
}
 
function checkValue(field) {
	if((field.value < 0) || (((field.name == "Maximum Number of Connections") || (field.name == "Maximum Throughput")) && (field.value != Math.round(field.value)))) {
		alert(field.name + " must be a positive integer");
		field.value = field.defaultValue;
	}
}

function submitChangedValues() {
	if(document.forms[0].elements[1].defaultValue == document.forms[0].elements[1].value)
		document.forms[0].elements[1].name += "$";
	if(document.forms[0].elements[2].defaultValue == document.forms[0].elements[2].value)
		document.forms[0].elements[2].name += "$";		
	if((document.forms[0].elements[3].defaultChecked == document.forms[0].elements[3].checked) &&
	 (document.forms[0].elements[4].defaultChecked == document.forms[0].elements[4].checked)) {
			document.forms[0].elements[3].name += "$";
			document.forms[0].elements[4].name += "$";
	}
	else {
		if(document.forms[0].elements[3].checked) {
			document.forms[0].elements[3].value = "on";
			document.forms[0].elements[4].value = "on";
		}
		else {
			document.forms[0].elements[3].value = "off";
			document.forms[0].elements[4].value = "off";
		}
	}
	if(document.forms[0].elements[5].defaultValue == document.forms[0].elements[5].value)
		document.forms[0].elements[5].name += "$";
	if(document.forms[0].elements[6].defaultValue == document.forms[0].elements[6].value)
		document.forms[0].elements[6].name += "$";
	if(document.forms[0].elements[7].options[0].defaultSelected == document.forms[0].elements[7].options[0].selected)
		document.forms[0].elements[7].name += "$";
		
	if(document.forms[0].elements[9].value == "") {
	        document.forms[0].elements[10].value == "";
		document.forms[0].elements[9].name += "$";
	}
	else if ((document.forms[0].elements[8].value == "1") && (document.forms[0].elements[9].value == document.forms[0].elements[10].value)) {
		var pass = document.forms[0].elements[9].value;
		//document.forms[0].elements[9].value = base64Encode(pass);
		document.forms[0].elements[9].value = pass;
		document.forms[0].elements[10].value = "";
	}
	else {
		document.forms[0].elements[9].value = "";
		document.forms[0].elements[10].value = "";
		document.forms[0].elements[9].name += "$";
	}
	document.forms[0].submit();		
}

function base64ToAscii(c)
{
	var theChar = 0;
	
	if (0 <= c && c <= 25)
	{
		theChar = String.fromCharCode(c + 65);
	}
	else if (26 <= c && c <= 51)
	{
		theChar = String.fromCharCode(c - 26 + 97);
	}
	else if (52 <= c && c <= 61)
	{
		theChar = String.fromCharCode(c - 52 + 48);
	}
	else if (c == 62)
	{
		theChar = '+';
	}
	else if( c == 63 )
	{
		theChar = '/';
	}
	else
	{
		theChar = String.fromCharCode(0xFF);
	}

	return theChar;
}


function base64Encode(str) {
	var result = "";
	var i = 0;
	var sextet = 0;
	var leftovers = 0;
	var octet = 0;

	for (i=0; i < str.length; i++) {
		octet = str.charCodeAt(i);
		switch( i % 3 )
		{
			case 0:
			{
				sextet = ( octet & 0xFC ) >> 2 ;
				leftovers = octet & 0x03 ;

				// sextet contains first character in quadruple
				break;
			}

			case 1:
			{
				sextet = ( leftovers << 4 ) | ( ( octet & 0xF0 ) >> 4 );
				leftovers = octet & 0x0F ;

				// sextet contains 2nd character in quadruple
				break;
			}

			case 2:
			{
				sextet = ( leftovers << 2 ) | ( ( octet & 0xC0 ) >> 6 ) ;
				leftovers = ( octet & 0x3F ) ;

				// sextet contains third character in quadruple
				// leftovers contains fourth character in quadruple
				break;
			}
		}

		result = result + base64ToAscii(sextet);

		// don't forget about the fourth character if it is there
		if( (i % 3) == 2 )
		{
			result = result + base64ToAscii(leftovers);
		} 

	}

	// figure out what to do with leftovers and padding
	switch( str.length % 3 )
	{
		case 0:
		{
			// an even multiple of 3, nothing left to do
			break ;
		}
		case 1:
		{
			// one 6-bit chars plus 2 leftover bits
			leftovers =  leftovers << 4 ;
			result = result + base64ToAscii(leftovers);
			result = result + "==";
			break ;
		}
		case 2:
		{
			// two 6-bit chars plus 4 leftover bits
			leftovers = leftovers << 2 ;
			result = result + base64ToAscii(leftovers);
			result = result + "=";
			break ;
		}
	}

	return result;
}

function init() {
toploded = top.nav.loded;
	if(typeof(toploded) == "number") {
	top.nav.selekt('2');
	top.nav.subSelekt('2A');
	setOpts();
	} else {
	setTimeout("init()", 200);
	}
}

</SCRIPT>
<STYLE TYPE="text/css">	
		TD { font: 12px/14px arial, helvetica, trebuchet MS, geneva, sans-serif; margin-top: 0px; margin-left: 0px; font-weight: plain; margin-bottom: 0px; }
		.headline { font: 30px/30px arial, helvetica, trebuchet MS, geneva, sans-serif; margin-top: 0px; margin-left: 0px; font-weight: plain; margin-bottom: 0px; color: #B7BED2; }
		.whiteheader { font: 16px/17px arial, helvetica, trebuchet MS, geneva, sans-serif; margin-top: 0px; margin-left: 0px; font-weight: bold; margin-bottom: 0px; color: #FFFFFF; }
		.dkgrayheader { font: 13px/15px arial, helvetica, trebuchet MS, geneva, sans-serif; margin-top: 0px; margin-left: 0px; font-weight: bold; margin-bottom: 0px; color: #333333; }
		.copyheader { font: 12px/14px arial, helvetica, trebuchet MS, geneva, sans-serif; margin-top: 0px; margin-left: 0px; font-weight: bold; margin-bottom: 0px; }

</STYLE> 
</HEAD>
<BODY BGCOLOR="#FFFFFF" onLoad="setOpts()">
<FORM NAME="generalsettings" METHOD="GET" ACTION="setgensettings.cgi">
<CENTER><BR>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="85%" HEIGHT=32>
   <TR>
	<TD WIDTH="455" CLASS="headline">General Settings</TD>
      <TD ALIGN="center" WIDTH="100"><INPUT TYPE=submit NAME=Submit VALUE="Submit" onClick="submitChangedValues()"></TD>
   </TR>
</TABLE>
 <TABLE BORDER="0" CELLSPACING="4" CELLPADDING="1" ALIGN="CENTER">
            <TR>
               <TD ALIGN="right" CLASS="copyheader">Movies Directory:</TD>
               <TD><INPUT TYPE=text NAME="Movies Directory" VALUE="<%%ECHODATA /server/qtssSvrPreferences/movie_folder%%>" SIZE=50></TD>
            </TR>
            <TR>
               <TD></TD>
               <TD><BR>
                  <BR></TD>
            </TR>
            <TR>
                 <TD ALIGN="right" CLASS="copyheader">Server Name/Default Realm:</TD>
               <TD><INPUT TYPE=text NAME="Server Name" VALUE="<%%ECHODATA /server/qtssSvrPreferences/default_authorization_realm%%>" SIZE=32></TD>
            </TR>
            <TR>
		       <TD></TD>
               <TD><BR>
                  <BR></TD>
            </TR>
            </TR>
            <TR>
               	<%%GETDATA rtspport /server/qtssSvrPreferences/rtsp_port/*%%>
 				<%%MAKEARRAY ports /server/qtssSvrPreferences/rtsp_port/ rtspport%%>
    			<%%HASVALUE has80 ports '80' num%%>
                  <TD ALIGN="right" CLASS="copyheader">Streaming on Port 80:</TD>               
               <TD><%%FORMATRADIOBUTTON has80 'Streaming on Port 80' 'on' checked%%>Enabled</TD>
            </TR>
            <TR>
               <TD></TD>
               <TD><%%FORMATRADIOBUTTON has80 'Streaming on Port 80' 'off' unchecked%%>Disabled</TD>
            </TR>
            <TR>
               <TD></TD>
               <TD><BR>
                  <BR></TD>
            </TR>
            <TR>
               <TD ALIGN="right" CLASS="copyheader">Maximum Number of Connections:</TD>
               <TD><INPUT TYPE=text NAME="Maximum Number of Connections" VALUE="<%%ECHODATA /server/qtssSvrPreferences/maximum_connections%%>" SIZE=4 MAXLENGTH=4 ONCHANGE="checkValue(this)"></TD>
            </TR>
            <TR>
               <TD></TD>
               <TD><BR>
                  <BR></TD>
            </TR>
            <TR>
               <TD ALIGN="right" CLASS="copyheader">Maximum Throughput:</TD>
               <TD>
               		<%%GETVALUE maxThroughput /server/qtssSvrPreferences/maximum_bandwidth%%>
					<INPUT TYPE=text NAME="Maximum Throughput" VALUE="<%%MODIFYDATA maxThroughput '> 9999' '/ 1024'%%>" SIZE=4 MAXLENGTH=4 ONCHANGE="checkValue(this)">
					<%%FORMATSELECTOPTION maxThroughput 'Display Throughput' '< 9999' 'Kbps' 'Mbps' 1%%>
               </TD>
            </TR>
            <TR>
               <TD></TD>
               <TD><BR>
                  <BR></TD>
            </TR>
            <TR>
               <TD ALIGN="right"><%%IFREMOTE '<FONT COLOR="#FF0000">Note:</FONT>' ''%%></TD>
               <TD><%%IFREMOTE '<FONT COLOR="#FF0000">The Administrator Password cannot be changed when using WebAdmin remotely.</FONT>' ''%%></TD>
            </TR>
            <INPUT TYPE="hidden" NAME="local" VALUE="<%%IFREMOTE '0' '1'%%>">
            <TR>
				<TD ALIGN="right" CLASS="copyheader">Administrator's New Password:</TD>
				<TD><INPUT TYPE="password" NAME="Administrator Password" VALUE="" SIZE="32"></TD>
			</TR>
			<TR>
				<TD ALIGN="right" CLASS="copyheader">Re-enter Administrator's New Password:</TD>
				<TD><INPUT TYPE="password" NAME="Administrator Password2" VALUE="" SIZE="32"></TD>
			</TR>
</TABLE>
</CENTER>
</FORM>
</BODY>
</HTML>
